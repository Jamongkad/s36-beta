jQuery(function(k){k("abbr.timeago").timeago();k(document).delegate("a.cat-picks","click",function(m){var n=false;k(this).parent().siblings().children("a").each(function(){k(this).removeClass("Matched")});if(!n){k(this).addClass("Matched")}var o=new CatPickObject(k(this));o.process();o.undo();m.preventDefault()});k(document).delegate("a.menubtn","click",function(m){var n=false;k(this).parent().children("a.menubtn").each(function(){k(this).removeClass("matched")});if(!n){k(this).addClass("matched")}k.ajax({type:"GET",url:k(this).attr("href"),success:function(p){var o=new Status();console.log("mathew");o.notify("Processing...",10000)}});m.preventDefault()});k(document).delegate("a.flagged","click",function(m){k(this).toggleClass("matched");var n=k(this).attr("state");var o;if(n==0){k(this).attr("state",1);o=1}else{k(this).attr("state",0);o=0}k.ajax({type:"GET",data:{state:o},url:k(this).attr("href"),success:function(q){var p=new Status();p.notify("Processing...",1000)}});m.preventDefault()});k(document).delegate("a.delete","click",function(m){if(confirm("Are you sure you want to delete this feedback?")){return true}m.preventDefault()});k(".reply").bind("click",function(m){var n=k(this).attr("hrefaction");window.location=n;m.preventDefault()});var g={};k(".add-bcc > li").bind("click",function(o){var m=k(this).index();var n="<input type='text' name='bcc[]' value='"+k(this).text()+"' />  <a class='delete-bcc' id='"+m+"' href='#'>[x]</a>";if(typeof g[m]=="undefined"){k("#bcc-target").append(n);g[m]=true}k(".delete-bcc").unbind("click.delete-bcc").bind("click.delete-bcc",function(q){var p=k(this).attr("id");k(this).prev("input").remove().end().remove();delete g[p];q.preventDefault()});o.preventDefault()});k("#themeId_1 input:radio").attr("checked",true);k("div.category-picker-holder, div.fast-forward-holder, .ff-form, #notification-message").hide();var a=false;k(".contact, .fileas, .forward").hover(function(){a=true},function(){a=false});k(document).delegate(".fileas","click",function(n){var m=k(this).attr("id");k("#"+m+" div.category-picker-holder").show().hover(function(){a=true},function(){a=false});n.preventDefault()});k('textarea[name="email_comment"]').bind("focus",function(){k(this).val("")});k(document).delegate(".contact, .forward","click",function(p){var m=k(this).attr("id");var n;var o=k(this).attr("class");if(o=="contact"){n=k("#"+m+" div.fast-forward-holder")}if(o=="forward"){n=k("#"+m)}n.show().hover(function(){k("div.email-list > ul.email-picker li",this).live("click",function(){var q=k(this);q.parent().hide().siblings(".ff-form").ajaxForm({success:function(){q.parents("div.fast-forward-holder").hide().end().parents(".email-picker").show().end().parent().siblings(".ff-form").hide().children(".ff-forward-to").html("").end();k('textarea[name="email_comment"]').val("");alert("Fast-forward sent to "+k("a",q).text())}}).children(".ff-forward-to").html(k(this).html()).end().children('input[name="email"]').val(k("a",this).html()).end().show()});a=true},function(){a=false});p.preventDefault()});k("body").click(function(){if(!a){k("div.fast-forward-holder, div.category-picker-holder, .ff-form").hide();k(".email-picker").show();k('textarea[name="email_comment"]').val("")}});new InboxStatusChange(".check, .feature, .remove, .popup-delete").initialize();k("div.undo-bar").hide();new Switcharoo().start_switch("-100px 0px");k.each(k("ul#nav-menu li"),function(n,m){k(m).bind("click",function(o){window.location=k(this).children("a").attr("href")})});var h=new Checky({feed_selection:".feed-selection",check_feed_id:".check-feed-id",category_feed_id:".category-feed-id",click_all:".click-all"});h.init();h.clickAll();k(".status-change > select, .priority-change > select").hide();var l=new DropDownChange({status_element:"span.status-change",status_selector:"change.status"});l.enable();var f=new DropDownChange({status_element:"span.priority-change",status_selector:"change.priority"});f.enable();k(".check").fancytips();k(".fileas").fancytips();k(".reply").fancytips();k(".feature").fancytips();k(".contact").fancytips();k(".flag").fancytips();k(".remove").fancytips({top:45});k("a.perm-delete").click(function(m){if(confirm("Are you sure you want to permanently delete this feedback?")){return true}m.preventDefault()});c();k("a.add-new-ctgy").bind("click",function(m){var o=k("input[name='category_nm']");var n=k("#ctgy-list");if(o.val()==false){alert("Category Name cannot be blank.")}else{k.ajax({url:n.attr("hrefaction"),type:"POST",data:{ctgy_nm:o.val(),companyId:k("input[name='companyid']").val()},success:function(p){n.append(p);o.val("");c()}})}m.preventDefault()});function c(){k("a.rename-ctgy, a.delete-ctgy").unbind("click.ctgy-controls").bind("click.ctgy-controls",function(q){var p=k(this).attr("class");var o=k(this);if(p=="rename-ctgy"){var n=k('<input type="text" name="ctgy_nm"/>').val(o.parents("div").siblings("div").children(".ctgy-name").html());if(o.text()=="Update"){var m=k('input[name="ctgy_nm"]').val();console.log("Rename");o.text("Rename").parents("div").siblings("div").children(".ctgy-name").html(m).end().end().end();k.ajax({url:o.attr("href"),type:"POST",data:{ctgy_nm:m}})}else{o.text("Update").parents("div").siblings("div").children(".ctgy-name").html(n).end().end().end()}}if(p=="delete-ctgy"){var r=o.parents("div.grids");if(confirm("Are you sure you want to delete this category? There is no undo.")){k.ajax({url:k(this).attr("href"),success:function(s){r.fadeOut()}})}}q.preventDefault()})}var d,e;function j(){k("#jcrop_target").Jcrop({setSelect:["40","20","190","170"],boxWidth:350,boxHeight:230,aspectRatio:1,onChange:b,onSelect:b},function(){d=this})}function b(q){var m=100/q.w;var p=100/q.h;var r=k("#jcrop_target");var o=r.height();var n=r.width();k("#x").val(q.x);k("#y").val(q.y);k("#w").val(q.w);k("#h").val(q.h);k("#preview").css({width:Math.round(m*n)+"px",height:Math.round(p*o)+"px",marginLeft:"-"+Math.round(m*q.x)+"px",marginTop:"-"+Math.round(p*q.y)+"px"})}function i(){var s=k("#fb_flag").val();var n=k("#x").val();var m=k("#y").val();var t=k("#w").val();var q=k("#h").val();var p=k("#preview").attr("src");var o=k("#crop_status");var r=k('input[name="cropped_image_nm"]').val();o.html(" Cropping Photo...");k.ajax({url:k("#ajax-crop-url").attr("hrefaction"),method:"GET",async:true,data:"&src="+p+"&x_coords="+n+"&y_coords="+m+"&wd="+t+"&ht="+q+"&oldphoto="+r+"&fb_login="+s,success:function(v){o.fadeOut("fast",function(){k('input[name="cropped_image_nm"]').val(v)});var u=new Status();u.notify("Your photo is successfully cropped! If you feel this is the right photo for you please click on the Save Settings button.",7000)}})}k("div.adjust-crop").hide();k(document).delegate("#your_photo","change",function(){k.ajaxFileUpload({url:k("#ajax-upload-url").attr("hrefaction"),secureuri:false,fileElementId:"your_photo",dataType:"json",success:function(m,n){var o=new Status();o.notify("Photo Upload Success!",1000);var q="/"+m.dir;var s=Math.round(m.wid);var r=k("div.jcrop_div");var p=k('input[name="existing_avatar"]');k("div.adjust-crop").show();k("#profile_picture").attr("src",q);k("#jcrop_target").attr("src",q);k("#preview").attr("src",q);if(d){d.setImage(k("#profile_picture").attr("src"));d.setSelect(["40","20","190","170"])}if(p.length>0){k.post(k("#ajax-delete-existing-avatar").attr("hrefaction"),{avatar:p.val()})}r.css({width:s});k('input[name="orig_image_dir"]').val(q);j()}})});k("#cropbtn").click(function(){i()});k(document).delegate("a.save","click",function(p){var n=k(".feedback-textarea");var m=n.attr("hrefaction");var o=k("#feed-id").val();k.post(m,{feed_id:o,feedback_text:n.val()},function(r){var q=new Status();q.notify("Processing...",1000)});p.preventDefault()});k("a.admin-delete").bind("click",function(m){if(confirm("Are you sure you want to delete this user? There is no undo.")){return true}m.preventDefault()});k(".contact-edit").bind("click",function(m){var n=k(this).attr("hrefaction");window.location=n;m.preventDefault()});k(".contact-delete").bind("click",function(o){var m=k(this).attr("hrefaction");var n=this;if(confirm("Are you sure you want to delete this user? There is no undo.")){k.get(m,function(p){k(n).parents("tr").fadeOut(350)})}o.preventDefault()});k(".copycheck").hide();k("#widget-preview").hide();new ZClip()});